import{a as E,b as l,c as N,d as _,f as u,h as A,j as M,k,n as D,p as q}from"./chunk-GMB2OH5J.js";import{a as G}from"./chunk-IWK7SOX5.js";import{a as R}from"./chunk-F4SQSF7Y.js";import{c as S,d as y,f as w}from"./chunk-EPYS6DY5.js";import"./chunk-X4BA4ZY7.js";import"./chunk-VHIVGA7J.js";import{k as F,p as b}from"./chunk-JTZO6T7H.js";import{Db as n,Lb as p,Na as s,Sa as c,Xa as C,d as x,hb as a,ob as o,pb as r,qb as d,vb as h}from"./chunk-NWJZ2U3V.js";var f=x(G());var g=m=>({"form-control":!0,error:m}),H=(()=>{class m{constructor(i,t,e){this.fb=i,this._user=t,this.router=e;let v={firstname:new u("",[l.required]),lastname:new u("",[l.required]),email:new u("",[l.required,l.email]),password:new u("",[l.required,l.minLength(8)]),role:new u("user")};this.registerForm=i.group(v)}createAccount(){let i=this.registerForm.value;i.email=i.email.trim(),console.log("Registration payload:",i),this._user.register(i).subscribe({next:t=>{f.default.fire({position:"top-end",icon:"success",title:"Registration successful! Redirecting to login...",showConfirmButton:!1,timer:1500}).then(()=>this.router.navigate(["/login"]))},error:t=>{console.error("Registration Error:",t);let e="An error occurred";t.status===400&&(e=t.error?.message||"Registration failed. Please check your input."),f.default.fire({position:"top-end",icon:"error",title:e,showConfirmButton:!1,timer:1500})}})}updateRole(i,t){this._user.updateUserRole(i,t).subscribe({next:e=>{console.log("User role updated to:",t),t==="admin"&&this.router.navigate(["/admin"])},error:e=>{console.error("Error updating role",e)}})}static{this.\u0275fac=function(t){return new(t||m)(c(D),c(R),c(S))}}static{this.\u0275cmp=C({type:m,selectors:[["app-register"]],decls:33,vars:14,consts:[["role","document",1,"modal-dialog","modal-dialog-centered","login-pop-form"],["id","registermodal",1,"modal-content"],[1,"modal-header"],[1,"modal-body"],[1,"login-form"],[3,"ngSubmit","formGroup"],[1,"form-group"],["type","text","formControlName","firstname",3,"ngClass"],["type","text","formControlName","lastname",3,"ngClass"],["type","text","formControlName","email",1,"form-control",3,"ngClass"],["type","password","formControlName","password",3,"ngClass"],["type","submit",1,"btn","dark-2","btn-md","full-width","pop-login",3,"disabled"],[1,"modal-footer"],[1,"mf-link"],[1,"ti-user"],["routerLink","/login",1,"theme-cl"]],template:function(t,e){t&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4"),n(4,"Sign Up"),r()(),o(5,"div",3)(6,"div",4)(7,"form",5),h("ngSubmit",function(){return e.createAccount()}),o(8,"div",6)(9,"label"),n(10,"First Name"),r(),d(11,"input",7),r(),o(12,"div",6)(13,"label"),n(14,"Last Name"),r(),d(15,"input",8),r(),o(16,"div",6)(17,"label"),n(18,"E-mail"),r(),d(19,"input",9),r(),o(20,"div",6)(21,"label"),n(22,"Password"),r(),d(23,"input",10),r(),o(24,"div",6)(25,"button",11),n(26,"Register"),r()()()()(),o(27,"div",12)(28,"div",13),d(29,"i",14),n(30,"Have An Account?"),o(31,"a",15),n(32," Sign In"),r()()()()()),t&2&&(s(7),a("formGroup",e.registerForm),s(4),a("ngClass",p(6,g,e.registerForm.controls.firstname.touched&&e.registerForm.controls.firstname.invalid)),s(4),a("ngClass",p(8,g,e.registerForm.controls.lastname.touched&&e.registerForm.controls.lastname.invalid)),s(4),a("ngClass",p(10,g,e.registerForm.controls.email.touched&&e.registerForm.controls.email.invalid)),s(4),a("ngClass",p(12,g,e.registerForm.controls.password.touched&&e.registerForm.controls.password.invalid)),s(2),a("disabled",e.registerForm.invalid))},dependencies:[w,y,q,A,E,N,_,M,k,b,F],encapsulation:2})}}return m})();export{H as RegisterComponent};
